<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL é€ŸæŸ¥è¡¨ | ç»“æ„åŒ–å®Œæ•´ç‰ˆ</title>
    <!-- å¼•å…¥Tailwind CSSï¼ˆæ ·å¼æ¡†æ¶ï¼Œå¿«é€Ÿå¼€å‘ï¼‰ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥Prism.jsï¼ˆä»£ç é«˜äº®ï¼Œæ”¯æŒSQLè¯­æ³•ï¼‰ -->
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-sql.min.js"></script>
    <!-- è‡ªå®šä¹‰Tailwindé…ç½® -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#475569',
                        dark: '#0f172a',
                        light: '#f8fafc',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .nav-active {
                @apply bg-primary/10 text-primary border-l-4 border-primary;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-dark">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="sticky top-0 z-50 bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary">SQL é€ŸæŸ¥è¡¨</h1>
            <p class="hidden sm:block text-secondary">ç»“æ„åŒ–å®Œæ•´ç‰ˆ | è¦†ç›–DDL/DML/DQL/é«˜çº§è¯­æ³•</p>
            <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
            <button id="menuBtn" class="sm:hidden text-dark text-xl">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </header>

    <div class="container mx-auto px-4 py-6 flex flex-col lg:flex-row gap-6">
        <!-- å·¦ä¾§ä¾§è¾¹å¯¼èˆªï¼ˆå›ºå®šï¼Œæ¡Œé¢ç«¯ï¼‰ -->
        <aside id="sidebar" class="lg:w-64 w-full lg:sticky lg:top-24 h-fit lg:h-[calc(100vh-8rem)] bg-white rounded-lg shadow-sm p-4 overflow-y-auto scrollbar-hide hidden sm:block">
            <h2 class="text-lg font-semibold mb-4 pb-2 border-b border-gray-200">ç›®å½•å¯¼èˆª</h2>
            <nav class="space-y-1">
                <a href="#ddl" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">ä¸€ã€æ•°æ®å®šä¹‰è¯­è¨€ (DDL)</a>
                <a href="#dml" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">äºŒã€æ•°æ®æ“ä½œè¯­è¨€ (DML)</a>
                <a href="#dql" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">ä¸‰ã€æ•°æ®æŸ¥è¯¢è¯­è¨€ (DQL)</a>
                <a href="#join" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">å››ã€è¿æ¥æŸ¥è¯¢ (JOIN)</a>
                <a href="#subquery" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">äº”ã€å­æŸ¥è¯¢ä¸é›†åˆæ“ä½œ</a>
                <a href="#function" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">å…­ã€å¸¸ç”¨å‡½æ•°</a>
                <a href="#window" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">ä¸ƒã€çª—å£å‡½æ•°</a>
                <a href="#index" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">å…«ã€ç´¢å¼•ç®¡ç†</a>
                <a href="#view" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">ä¹ã€è§†å›¾</a>
                <a href="#procedure" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">åã€å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</a>
                <a href="#tcl" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">åä¸€ã€äº‹åŠ¡æ§åˆ¶ (TCL)</a>
                <a href="#dcl" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">åäºŒã€æƒé™ç®¡ç† (DCL)</a>
                <a href="#tips" class="nav-item block px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">åä¸‰ã€å®ç”¨æŠ€å·§</a>
            </nav>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="flex-1 bg-white rounded-lg shadow-sm p-6">
            <!-- ä¸€ã€æ•°æ®å®šä¹‰è¯­è¨€ (DDL) -->
            <section id="ddl" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ ä¸€ã€æ•°æ®å®šä¹‰è¯­è¨€ (DDL)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 1.1 æ•°æ®åº“æ“ä½œ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">1.1 æ•°æ®åº“æ“ä½œ</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE database_name;

-- åˆ é™¤æ•°æ®åº“
DROP DATABASE database_name;

-- å¤‡ä»½æ•°æ®åº“
BACKUP DATABASE database_name TO DISK = 'filepath';

-- å·®å¼‚å¤‡ä»½
BACKUP DATABASE database_name TO DISK = 'filepath' WITH DIFFERENTIAL;

-- ä½¿ç”¨æ•°æ®åº“
USE database_name;</code></pre>
                        </div>
                    </div>

                    <!-- 1.2 è¡¨æ“ä½œ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">1.2 è¡¨æ“ä½œ</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- åˆ›å»ºè¡¨
CREATE TABLE table_name (
    column1 datatype [constraints],
    column2 datatype [constraints],
    column3 datatype [constraints],
    ...
    [table_constraints]
);

-- åˆ é™¤è¡¨
DROP TABLE table_name;

-- æ¸…ç©ºè¡¨ï¼ˆä¿ç•™ç»“æ„ï¼‰
TRUNCATE TABLE table_name;

-- ä¿®æ”¹è¡¨ç»“æ„
ALTER TABLE table_name
ADD column_name datatype;          -- æ·»åŠ åˆ—

ALTER TABLE table_name
DROP COLUMN column_name;           -- åˆ é™¤åˆ—

ALTER TABLE table_name
ALTER COLUMN column_name datatype; -- ä¿®æ”¹åˆ—æ•°æ®ç±»å‹ï¼ˆSQL Serverï¼‰

ALTER TABLE table_name
MODIFY column_name datatype;       -- ä¿®æ”¹åˆ—æ•°æ®ç±»å‹ï¼ˆMySQLï¼‰

ALTER TABLE table_name
RENAME COLUMN old_name TO new_name;-- é‡å‘½ååˆ—

ALTER TABLE table_name
RENAME TO new_table_name;          -- é‡å‘½åè¡¨</code></pre>
                        </div>
                    </div>

                    <!-- 1.3 çº¦æŸ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">1.3 çº¦æŸ (Constraints)</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- ä¸»é”®çº¦æŸ
CREATE TABLE table_name (
    id INT PRIMARY KEY,
    ...
);

-- å¤–é”®çº¦æŸ
CREATE TABLE table_name (
    customer_id INT,
    FOREIGN KEY (customer_id) REFERENCES Customers(id)
);

-- å”¯ä¸€çº¦æŸ
CREATE TABLE table_name (
    email VARCHAR(100) UNIQUE,
    ...
);

-- éç©ºçº¦æŸ
CREATE TABLE table_name (
    name VARCHAR(100) NOT NULL,
    ...
);

-- æ£€æŸ¥çº¦æŸ
CREATE TABLE table_name (
    age INT CHECK (age >= 18),
    salary DECIMAL CHECK (salary > 0)
);

-- é»˜è®¤å€¼
CREATE TABLE table_name (
    created_at DATE DEFAULT CURRENT_DATE,
    is_active BOOLEAN DEFAULT TRUE
);</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- äºŒã€æ•°æ®æ“ä½œè¯­è¨€ (DML) -->
            <section id="dml" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ äºŒã€æ•°æ®æ“ä½œè¯­è¨€ (DML)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 2.1 æ’å…¥æ•°æ® -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">2.1 æ’å…¥æ•°æ®</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- æ’å…¥å®Œæ•´è¡Œ
INSERT INTO table_name VALUES (value1, value2, value3, ...);

-- æ’å…¥æŒ‡å®šåˆ—
INSERT INTO table_name (column1, column2, column3, ...)
VALUES (value1, value2, value3, ...);

-- æ’å…¥å¤šè¡Œ
INSERT INTO table_name (column1, column2, ...)
VALUES 
    (value1a, value2a, ...),
    (value1b, value2b, ...),
    (value1c, value2c, ...);

-- ä»å…¶ä»–è¡¨æ’å…¥
INSERT INTO table2 (column1, column2, ...)
SELECT column1, column2, ...
FROM table1
WHERE condition;</code></pre>
                        </div>
                    </div>

                    <!-- 2.2 æ›´æ–°æ•°æ® -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">2.2 æ›´æ–°æ•°æ®</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- æ›´æ–°æ‰€æœ‰è¡Œ
UPDATE table_name
SET column1 = value1, column2 = value2, ...;

-- æ›´æ–°æ»¡è¶³æ¡ä»¶çš„è¡Œ
UPDATE table_name
SET column1 = value1, column2 = value2, ...
WHERE condition;

-- ä½¿ç”¨å­æŸ¥è¯¢æ›´æ–°
UPDATE table_name
SET column1 = (SELECT ...)
WHERE condition;</code></pre>
                        </div>
                    </div>

                    <!-- 2.3 åˆ é™¤æ•°æ® -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">2.3 åˆ é™¤æ•°æ®</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- åˆ é™¤æ‰€æœ‰è¡Œï¼ˆå¯å›æ»šï¼‰
DELETE FROM table_name;

-- åˆ é™¤æ»¡è¶³æ¡ä»¶çš„è¡Œ
DELETE FROM table_name
WHERE condition;

-- å¿«é€Ÿæ¸…ç©ºè¡¨ï¼ˆä¸å¯å›æ»šï¼‰
TRUNCATE TABLE table_name;</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ä¸‰ã€æ•°æ®æŸ¥è¯¢è¯­è¨€ (DQL) -->
            <section id="dql" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ ä¸‰ã€æ•°æ®æŸ¥è¯¢è¯­è¨€ (DQL)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 3.1 åŸºæœ¬æŸ¥è¯¢ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">3.1 åŸºæœ¬æŸ¥è¯¢</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- æŸ¥è¯¢æ‰€æœ‰åˆ—
SELECT * FROM table_name;

-- æŸ¥è¯¢æŒ‡å®šåˆ—
SELECT column1, column2, ... FROM table_name;

-- æŸ¥è¯¢å”¯ä¸€å€¼
SELECT DISTINCT column1, column2, ... FROM table_name;

-- ä½¿ç”¨åˆ«å
SELECT 
    column1 AS alias1,
    column2 AS alias2,
    ...
FROM table_name;

-- é™åˆ¶è¿”å›è¡Œæ•°
SELECT * FROM table_name LIMIT 10;           -- MySQL/PostgreSQL
SELECT TOP 10 * FROM table_name;             -- SQL Server
SELECT * FROM table_name WHERE ROWNUM <= 10; -- Oracle</code></pre>
                        </div>
                    </div>

                    <!-- 3.2 æ¡ä»¶ç­›é€‰ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">3.2 æ¡ä»¶ç­›é€‰</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- WHERE å­å¥
SELECT * FROM table_name WHERE condition;

-- æ¯”è¾ƒè¿ç®—ç¬¦
=, <>, !=, >, <, >=, <=

-- é€»è¾‘è¿ç®—ç¬¦
AND, OR, NOT

-- BETWEENï¼ˆåŒ…å«è¾¹ç•Œï¼‰
SELECT * FROM table_name
WHERE column BETWEEN value1 AND value2;

-- IN æ“ä½œç¬¦
SELECT * FROM table_name
WHERE column IN (value1, value2, value3, ...);

-- LIKE æ¨¡ç³ŠåŒ¹é…
SELECT * FROM table_name
WHERE column LIKE pattern;

-- æ¨¡å¼åŒ¹é…
%    -- ä»»æ„å­—ç¬¦åºåˆ—ï¼ˆ0æˆ–å¤šä¸ªå­—ç¬¦ï¼‰
_    -- å•ä¸ªä»»æ„å­—ç¬¦
[]   -- æŒ‡å®šèŒƒå›´å†…çš„å•ä¸ªå­—ç¬¦ï¼ˆSQL Serverï¼‰
[^]  -- ä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å•ä¸ªå­—ç¬¦ï¼ˆSQL Serverï¼‰

-- IS NULL / IS NOT NULL
SELECT * FROM table_name
WHERE column IS NULL;

SELECT * FROM table_name
WHERE column IS NOT NULL;</code></pre>
                        </div>
                    </div>

                    <!-- 3.3 æ’åºä¸åˆ†ç»„ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">3.3 æ’åºä¸åˆ†ç»„</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- æ’åº
SELECT * FROM table_name
ORDER BY column1 [ASC|DESC], column2 [ASC|DESC], ...;

-- åˆ†ç»„
SELECT column1, aggregate_function(column2)
FROM table_name
GROUP BY column1;

-- HAVING ç­›é€‰åˆ†ç»„
SELECT column1, COUNT(*)
FROM table_name
GROUP BY column1
HAVING COUNT(*) > 1;</code></pre>
                        </div>
                    </div>

                    <!-- 3.4 èšåˆå‡½æ•° -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">3.4 èšåˆå‡½æ•°</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">COUNT()     -- è®¡æ•°
SUM()       -- æ±‚å’Œ
AVG()       -- å¹³å‡å€¼
MIN()       -- æœ€å°å€¼
MAX()       -- æœ€å¤§å€¼
STDDEV()    -- æ ‡å‡†å·®
VARIANCE()  -- æ–¹å·®

-- ç¤ºä¾‹
SELECT 
    COUNT(*) AS total_rows,
    COUNT(DISTINCT column) AS unique_values,
    SUM(column) AS total,
    AVG(column) AS average,
    MIN(column) AS minimum,
    MAX(column) AS maximum
FROM table_name;</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å››ã€è¿æ¥æŸ¥è¯¢ (JOIN) -->
            <section id="join" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ å››ã€è¿æ¥æŸ¥è¯¢ (JOIN)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 4.1 è¿æ¥ç±»å‹ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">4.1 è¿æ¥ç±»å‹</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- å†…è¿æ¥ï¼ˆè¿”å›åŒ¹é…çš„è¡Œï¼‰
SELECT columns
FROM table1
INNER JOIN table2 ON table1.column = table2.column;

-- å·¦å¤–è¿æ¥ï¼ˆè¿”å›å·¦è¡¨æ‰€æœ‰è¡Œ + åŒ¹é…çš„å³è¡¨è¡Œï¼‰
SELECT columns
FROM table1
LEFT JOIN table2 ON table1.column = table2.column;

-- å³å¤–è¿æ¥ï¼ˆè¿”å›å³è¡¨æ‰€æœ‰è¡Œ + åŒ¹é…çš„å·¦è¡¨è¡Œï¼‰
SELECT columns
FROM table1
RIGHT JOIN table2 ON table1.column = table2.column;

-- å…¨å¤–è¿æ¥ï¼ˆè¿”å›æ‰€æœ‰åŒ¹é…å’Œä¸åŒ¹é…çš„è¡Œï¼‰
SELECT columns
FROM table1
FULL OUTER JOIN table2 ON table1.column = table2.column;

-- äº¤å‰è¿æ¥ï¼ˆç¬›å¡å°”ç§¯ï¼‰
SELECT columns
FROM table1
CROSS JOIN table2;

-- è‡ªè¿æ¥
SELECT e1.name AS employee, e2.name AS manager
FROM employees e1
LEFT JOIN employees e2 ON e1.manager_id = e2.id;</code></pre>
                        </div>
                    </div>

                    <!-- 4.2 å¤šè¡¨è¿æ¥ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">4.2 å¤šè¡¨è¿æ¥</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">SELECT 
    t1.column1,
    t2.column2,
    t3.column3
FROM table1 t1
INNER JOIN table2 t2 ON t1.id = t2.table1_id
LEFT JOIN table3 t3 ON t2.id = t3.table2_id
WHERE condition;</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- äº”ã€å­æŸ¥è¯¢ä¸é›†åˆæ“ä½œ -->
            <section id="subquery" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ äº”ã€å­æŸ¥è¯¢ä¸é›†åˆæ“ä½œ</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 5.1 å­æŸ¥è¯¢ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">5.1 å­æŸ¥è¯¢</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- æ ‡é‡å­æŸ¥è¯¢ï¼ˆè¿”å›å•ä¸ªå€¼ï¼‰
SELECT * FROM table1
WHERE column = (SELECT MAX(column) FROM table2);

-- åˆ—å­æŸ¥è¯¢ï¼ˆè¿”å›å•åˆ—å¤šè¡Œï¼‰
SELECT * FROM table1
WHERE column IN (SELECT column FROM table2 WHERE condition);

-- è¡Œå­æŸ¥è¯¢ï¼ˆè¿”å›å•è¡Œå¤šåˆ—ï¼‰
SELECT * FROM table1
WHERE (column1, column2) = (
    SELECT column1, column2 
    FROM table2 
    WHERE id = 1
);

-- è¡¨å­æŸ¥è¯¢ï¼ˆè¿”å›å¤šè¡Œå¤šåˆ—ï¼‰
SELECT * 
FROM (SELECT * FROM table1 WHERE condition) AS subquery
WHERE condition;

-- EXISTS å­æŸ¥è¯¢
SELECT * FROM table1
WHERE EXISTS (SELECT 1 FROM table2 WHERE table1.id = table2.table1_id);

-- ç›¸å…³å­æŸ¥è¯¢
SELECT 
    name,
    salary,
    (SELECT AVG(salary) FROM employees e2 WHERE e1.department = e2.department) AS dept_avg
FROM employees e1;</code></pre>
                        </div>
                    </div>

                    <!-- 5.2 é›†åˆæ“ä½œ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">5.2 é›†åˆæ“ä½œ</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- UNIONï¼ˆåˆå¹¶ç»“æœé›†ï¼Œå»é‡ï¼‰
SELECT column1, column2 FROM table1
UNION
SELECT column1, column2 FROM table2;

-- UNION ALLï¼ˆåˆå¹¶ç»“æœé›†ï¼Œä¸å»é‡ï¼‰
SELECT column1, column2 FROM table1
UNION ALL
SELECT column1, column2 FROM table2;

-- INTERSECTï¼ˆäº¤é›†ï¼‰
SELECT column1, column2 FROM table1
INTERSECT
SELECT column1, column2 FROM table2;

-- EXCEPT/MINUSï¼ˆå·®é›†ï¼‰
SELECT column1, column2 FROM table1
EXCEPT
SELECT column1, column2 FROM table2;</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å…­ã€å¸¸ç”¨å‡½æ•° -->
            <section id="function" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ å…­ã€å¸¸ç”¨å‡½æ•°</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 6.1 å­—ç¬¦ä¸²å‡½æ•° -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">6.1 å­—ç¬¦ä¸²å‡½æ•°</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">CONCAT(str1, str2, ...)       -- è¿æ¥å­—ç¬¦ä¸²
SUBSTRING(str, start, length) -- æå–å­ä¸²
CHAR_LENGTH(str)              -- å­—ç¬¦æ•°
LENGTH(str)                   -- å­—èŠ‚æ•°
UPPER(str), LOWER(str)        -- å¤§å°å†™è½¬æ¢
TRIM(str)                     -- å»é™¤ç©ºæ ¼
LEFT(str, length), RIGHT(str, length) -- å·¦å³æˆªå–
REPLACE(str, from_str, to_str) -- æ›¿æ¢
INSTR(str, substr)            -- æŸ¥æ‰¾ä½ç½®
LPAD(str, length, padstr)     -- å·¦å¡«å……
RPAD(str, length, padstr)     -- å³å¡«å……</code></pre>
                        </div>
                    </div>

                    <!-- 6.2 æ•°å€¼å‡½æ•° -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">6.2 æ•°å€¼å‡½æ•°</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">ROUND(number, decimals)        -- å››èˆäº”å…¥
CEILING(number)                -- å‘ä¸Šå–æ•´
FLOOR(number)                  -- å‘ä¸‹å–æ•´
ABS(number)                    -- ç»å¯¹å€¼
MOD(dividend, divisor)         -- å–æ¨¡
POWER(base, exponent)          -- å¹‚è¿ç®—
SQRT(number)                   -- å¹³æ–¹æ ¹
RAND()                         -- éšæœºæ•°</code></pre>
                        </div>
                    </div>

                    <!-- 6.3 æ—¥æœŸæ—¶é—´å‡½æ•° -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">6.3 æ—¥æœŸæ—¶é—´å‡½æ•°</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- å½“å‰æ—¥æœŸæ—¶é—´
NOW(), CURRENT_TIMESTAMP       -- å½“å‰æ—¥æœŸæ—¶é—´
CURDATE(), CURRENT_DATE        -- å½“å‰æ—¥æœŸ
CURTIME(), CURRENT_TIME        -- å½“å‰æ—¶é—´

-- æå–éƒ¨åˆ†
YEAR(date), MONTH(date), DAY(date)
HOUR(time), MINUTE(time), SECOND(time)

-- æ—¥æœŸè®¡ç®—
DATE_ADD(date, INTERVAL expr unit)  -- æ·»åŠ æ—¶é—´é—´éš”
DATE_SUB(date, INTERVAL expr unit)  -- å‡å»æ—¶é—´é—´éš”
DATEDIFF(date1, date2)              -- æ—¥æœŸå·®
TIMESTAMPDIFF(unit, start, end)     -- æ—¶é—´å·®

-- æ ¼å¼åŒ–
DATE_FORMAT(date, format)           -- æ ¼å¼åŒ–æ—¥æœŸ
STR_TO_DATE(str, format)            -- å­—ç¬¦ä¸²è½¬æ—¥æœŸ</code></pre>
                        </div>
                    </div>

                    <!-- 6.4 æ¡ä»¶å‡½æ•° -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">6.4 æ¡ä»¶å‡½æ•°</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- CASE è¡¨è¾¾å¼
SELECT 
    column1,
    CASE 
        WHEN condition1 THEN result1
        WHEN condition2 THEN result2
        ELSE default_result
    END AS new_column
FROM table_name;

-- IF å‡½æ•°ï¼ˆMySQLï¼‰
IF(condition, value_if_true, value_if_false)

-- COALESCEï¼ˆè¿”å›ç¬¬ä¸€ä¸ªéNULLå€¼ï¼‰
COALESCE(column1, column2, 'default')

-- NULLIFï¼ˆä¸¤å€¼ç›¸ç­‰è¿”å›NULLï¼‰
NULLIF(expr1, expr2)</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ä¸ƒã€çª—å£å‡½æ•° -->
            <section id="window" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ ä¸ƒã€çª—å£å‡½æ•°</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- æ’åå‡½æ•°
ROW_NUMBER() OVER (PARTITION BY ... ORDER BY ...)
RANK() OVER (PARTITION BY ... ORDER BY ...)
DENSE_RANK() OVER (PARTITION BY ... ORDER BY ...)
NTILE(n) OVER (PARTITION BY ... ORDER BY ...)

-- èšåˆçª—å£å‡½æ•°
SUM(column) OVER (PARTITION BY ...)
AVG(column) OVER (PARTITION BY ...)
COUNT(column) OVER (PARTITION BY ...)

-- åç§»å‡½æ•°
LAG(column, offset) OVER (PARTITION BY ... ORDER BY ...)
LEAD(column, offset) OVER (PARTITION BY ... ORDER BY ...)
FIRST_VALUE(column) OVER (PARTITION BY ... ORDER BY ...)
LAST_VALUE(column) OVER (PARTITION BY ... ORDER BY ...)

-- ç¤ºä¾‹
SELECT 
    department,
    employee,
    salary,
    ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) AS rank_in_dept,
    AVG(salary) OVER (PARTITION BY department) AS dept_avg_salary,
    LAG(salary) OVER (PARTITION BY employee_id ORDER BY date) AS prev_salary
FROM employees;</code></pre>
                    </div>
                </div>
            </section>

            <!-- å…«ã€ç´¢å¼•ç®¡ç† -->
            <section id="index" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ å…«ã€ç´¢å¼•ç®¡ç†</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- åˆ›å»ºç´¢å¼•
CREATE INDEX index_name ON table_name (column1, column2, ...);

-- åˆ›å»ºå”¯ä¸€ç´¢å¼•
CREATE UNIQUE INDEX index_name ON table_name (column);

-- åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX index_name ON table_name (col1, col2, col3);

-- åˆ é™¤ç´¢å¼•
DROP INDEX index_name ON table_name;           -- MySQL
DROP INDEX table_name.index_name;              -- SQL Server
DROP INDEX index_name;                         -- PostgreSQL/Oracle</code></pre>
                    </div>
                </div>
            </section>

            <!-- ä¹ã€è§†å›¾ -->
            <section id="view" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ ä¹ã€è§†å›¾</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- åˆ›å»ºè§†å›¾
CREATE VIEW view_name AS
SELECT columns
FROM tables
WHERE conditions;

-- åˆ›å»ºå¯æ›´æ–°è§†å›¾
CREATE VIEW view_name AS
SELECT columns
FROM table
WHERE conditions
WITH CHECK OPTION;

-- ä¿®æ”¹è§†å›¾
CREATE OR REPLACE VIEW view_name AS
SELECT columns
FROM tables
WHERE conditions;

-- åˆ é™¤è§†å›¾
DROP VIEW view_name;</code></pre>
                    </div>
                </div>
            </section>

            <!-- åã€å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•° -->
            <section id="procedure" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ åã€å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- åˆ›å»ºå­˜å‚¨è¿‡ç¨‹
CREATE PROCEDURE procedure_name
    @param1 datatype,
    @param2 datatype OUTPUT
AS
BEGIN
    -- SQL è¯­å¥
    SELECT @param2 = COUNT(*) FROM table WHERE column = @param1;
END;

-- æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹
EXEC procedure_name @param1 = value1, @param2 = @output OUTPUT;

-- åˆ›å»ºå‡½æ•°
CREATE FUNCTION function_name (@param datatype)
RETURNS return_datatype
AS
BEGIN
    DECLARE @result datatype;
    -- è®¡ç®—é€»è¾‘
    RETURN @result;
END;

-- è°ƒç”¨å‡½æ•°
SELECT dbo.function_name(parameter);</code></pre>
                    </div>
                </div>
            </section>

            <!-- åä¸€ã€äº‹åŠ¡æ§åˆ¶ (TCL) -->
            <section id="tcl" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ åä¸€ã€äº‹åŠ¡æ§åˆ¶ (TCL)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- å¼€å§‹äº‹åŠ¡
BEGIN TRANSACTION;    -- SQL Server
START TRANSACTION;    -- MySQL

-- æäº¤äº‹åŠ¡
COMMIT;

-- å›æ»šäº‹åŠ¡
ROLLBACK;

-- ä¿å­˜ç‚¹
SAVEPOINT savepoint_name;
ROLLBACK TO savepoint_name;

-- äº‹åŠ¡ç¤ºä¾‹
BEGIN TRY
    BEGIN TRANSACTION;
    
    -- ä¸€ç³»åˆ—æ“ä½œ
    UPDATE accounts SET balance = balance - 100 WHERE id = 1;
    UPDATE accounts SET balance = balance + 100 WHERE id = 2;
    
    COMMIT;
END TRY
BEGIN CATCH
    ROLLBACK;
    -- é”™è¯¯å¤„ç†
END CATCH;</code></pre>
                    </div>
                </div>
            </section>

            <!-- åäºŒã€æƒé™ç®¡ç† (DCL) -->
            <section id="dcl" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ åäºŒã€æƒé™ç®¡ç† (DCL)</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <div class="relative">
                        <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                        <pre><code class="language-sql">-- æˆäºˆæƒé™
GRANT privilege_list
ON object
TO user_or_role
[WITH GRANT OPTION];

-- æ’¤é”€æƒé™
REVOKE privilege_list
ON object
FROM user_or_role;

-- æƒé™ç¤ºä¾‹
GRANT SELECT, INSERT, UPDATE ON employees TO user1;
GRANT ALL PRIVILEGES ON database.* TO 'username'@'hostname';
REVOKE DELETE ON employees FROM user1;

-- åˆ›å»ºç”¨æˆ·
CREATE USER username IDENTIFIED BY 'password';

-- ä¿®æ”¹å¯†ç 
ALTER USER username IDENTIFIED BY 'new_password';

-- åˆ é™¤ç”¨æˆ·
DROP USER username;</code></pre>
                    </div>
                </div>
            </section>

            <!-- åä¸‰ã€å®ç”¨æŠ€å·§ -->
            <section id="tips" class="mb-10">
                <div class="flex justify-between items-center mb-4 cursor-pointer section-header">
                    <h2 class="text-2xl font-bold text-primary">ğŸ“Œ åä¸‰ã€å®ç”¨æŠ€å·§</h2>
                    <button class="text-xl text-secondary toggle-btn">âˆ’</button>
                </div>
                <div class="section-content space-y-6">
                    <!-- 13.1 åˆ†é¡µæŸ¥è¯¢ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">13.1 åˆ†é¡µæŸ¥è¯¢</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- MySQL/PostgreSQL
SELECT * FROM table_name
LIMIT 10 OFFSET 20;  -- è·³è¿‡20è¡Œï¼Œå–10è¡Œ

-- SQL Server
SELECT * FROM table_name
ORDER BY id
OFFSET 20 ROWS
FETCH NEXT 10 ROWS ONLY;

-- Oracle
SELECT * FROM (
    SELECT t.*, ROWNUM rnum
    FROM (SELECT * FROM table_name ORDER BY id) t
    WHERE ROWNUM <= 30
) WHERE rnum > 20;</code></pre>
                        </div>
                    </div>

                    <!-- 13.2 é€’å½’æŸ¥è¯¢ -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">13.2 é€’å½’æŸ¥è¯¢</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- é€’å½’æŸ¥è¯¢å±‚çº§ç»“æ„
WITH RECURSIVE cte_name AS (
    -- é”šå®šæˆå‘˜
    SELECT id, name, parent_id, 1 AS level
    FROM categories
    WHERE parent_id IS NULL
    
    UNION ALL
    
    -- é€’å½’æˆå‘˜
    SELECT c.id, c.name, c.parent_id, level + 1
    FROM categories c
    INNER JOIN cte_name ct ON c.parent_id = ct.id
)
SELECT * FROM cte_name;</code></pre>
                        </div>
                    </div>

                    <!-- 13.3 æ€§èƒ½ä¼˜åŒ–æç¤º -->
                    <div>
                        <h3 class="text-xl font-semibold mb-2">13.3 æ€§èƒ½ä¼˜åŒ–æç¤º</h3>
                        <div class="relative">
                            <button class="copy-btn absolute top-2 right-2 bg-primary/10 hover:bg-primary/20 text-primary px-2 py-1 rounded text-sm">å¤åˆ¶</button>
                            <pre><code class="language-sql">-- 1. ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢
EXPLAIN SELECT * FROM table WHERE condition;

-- 2. é¿å…SELECT *
SELECT column1, column2 FROM table;

-- 3. ä½¿ç”¨EXISTSä»£æ›¿INï¼ˆå¤§æ•°æ®é›†ï¼‰
SELECT * FROM table1 
WHERE EXISTS (SELECT 1 FROM table2 WHERE table1.id = table2.id);

-- 4. ä¸ºWHEREã€JOINã€ORDER BYçš„åˆ—åˆ›å»ºç´¢å¼•

-- 5. é¿å…åœ¨WHEREå­å¥ä¸­å¯¹åˆ—è¿›è¡Œå‡½æ•°æ“ä½œ
-- ä¸å¥½
SELECT * FROM table WHERE YEAR(date_column) = 2023;
-- å¥½
SELECT * FROM table WHERE date_column >= '2023-01-01' AND date_column < '2024-01-01';</code></pre>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- é¡µè„š -->
    <footer class="bg-white mt-10 py-6 border-t border-gray-200">
        <div class="container mx-auto px-4 text-center text-secondary">
            <p>SQL é€ŸæŸ¥è¡¨ | ç»“æ„åŒ–å®Œæ•´ç‰ˆ Â© 2025 | çº¯å‰ç«¯å¯ç›´æ¥ä½¿ç”¨</p>
        </div>
    </footer>

    <!-- JavaScript åŠŸèƒ½å®ç° -->
    <script>
        // 1. ç« èŠ‚æŠ˜å /å±•å¼€åŠŸèƒ½
        document.querySelectorAll('.section-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const toggleBtn = header.querySelector('.toggle-btn');
                // åˆ‡æ¢æ˜¾ç¤º/éšè—
                content.classList.toggle('hidden');
                // åˆ‡æ¢æŒ‰é’®ç¬¦å·
                toggleBtn.textContent = content.classList.contains('hidden') ? '+' : 'âˆ’';
            });
        });

        // 2. ä»£ç å¤åˆ¶åŠŸèƒ½
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', async (e) => {
                const codeBlock = e.target.nextElementSibling;
                const code = codeBlock.textContent;
                try {
                    await navigator.clipboard.writeText(code);
                    // ä¸´æ—¶ä¿®æ”¹æŒ‰é’®æ–‡å­—æç¤ºå¤åˆ¶æˆåŠŸ
                    const originalText = btn.textContent;
                    btn.textContent = 'å·²å¤åˆ¶';
                    btn.classList.add('bg-green-100', 'text-green-700');
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.classList.remove('bg-green-100', 'text-green-700');
                    }, 1500);
                } catch (err) {
                    btn.textContent = 'å¤åˆ¶å¤±è´¥';
                    btn.classList.add('bg-red-100', 'text-red-700');
                    setTimeout(() => {
                        btn.textContent = 'å¤åˆ¶';
                        btn.classList.remove('bg-red-100', 'text-red-700');
                    }, 1500);
                }
            });
        });

        // 3. å¯¼èˆªæ æ»šåŠ¨é«˜äº®å½“å‰ç« èŠ‚
        const sections = document.querySelectorAll('section');
        const navItems = document.querySelectorAll('.nav-item');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 100)) {
                    current = section.getAttribute('id');
                }
            });

            navItems.forEach(item => {
                item.classList.remove('nav-active');
                if (item.getAttribute('href').substring(1) === current) {
                    item.classList.add('nav-active');
                }
            });
        });

        // 4. ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        if (menuBtn && sidebar) {
            menuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('hidden');
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œä»£ç é«˜äº®
        document.addEventListener('DOMContentLoaded', () => {
            Prism.highlightAll();
        });
    </script>
</body>
</html>